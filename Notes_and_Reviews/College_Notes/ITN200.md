# Using Windows Server 2019 within an Organization

### Computer networks and the Internet in the 1990s
- PCs (client) connected to other computers across a computer network
- Obtained access to shared resources

### Server: a computer that shares a resource
- On-premises servers, cloud servers, rackmount servers, blade servers

### Rack servers (1U and 2U)
- Storage area network (SAN) devices, uninterruptible power supply (UPS) devices

---

# Understanding Windows Server Virtualization

### Virtualization
- Process of running more than one OS at the same time on a single computer
- requires hypervisor software

### Type 2 hypervisors run on top of an existing workstation OS

### Type 1 hypervisors interact with the hardware directly
- Contain a small OS to manage the hypervisor configuration and virtual machines
- Example: Microsoft Hyper-V

### Hypervisor requirements
- hypervisor acceleration
- Second Level Address Translation (SLAT) extensions

### Virtual Machine configuration file
- Stored within a file specific to the hypervisor

### OS virtual hard disk file
- Thick provisioning: allocates fixed space for the file when created
- Thin provisioning: dynamically allocating space as needed

### On-premises and cloud OS
- Virtual machines with a virtual hard disk file hosted on a SAN within the organization or cloud data center

### Nested Virtualization
- Running other VMs within an existing VM
- Example: Hyper-V
- Provides the ability to implement a more complex virtualization structure
- Provides the ability to create a complex virtualization structure on Windows 10 PCs for learning and testing purposes

---

# Understanding Windows Containers

### Sandboxing
- Enclosing executed Web apps in a way that isolates them from Web apps running within other containers and the underlying OS

### Docker: Common container software

### Windows Containers: Windows server component needed to use Docker

### Kernel: Core OS component 

### Hyper-V Containers
- Provide additional performance and security features to Web apps

---

# Windows Server 2019 Features

### Active Directory
- gives us a single on-domain and domain controller environment
- Windows server as an Active Directory domain controller
  - Gives us a single sign-on for other computers joined to a domain
- Has a Group Policy and an Active Directory Certificate Service feature

### Azure Active Directory
- Service hosted within Microsoft's Azure cloud
- Provides Active Directory services to an organization

### Security
- Microsoft Defender Advanced Threat Protection (ATP)
  - Performs a deep inspection of files and processes
- a shielded VM feature that protects Hyper-V virtual hard disk files
- Emphasis on Internet Information Services (IIS) Web server software
- Has more basic security features
  - File and folder permission, security policies, encryption of data, event auditing, various authentication methods, server management, and monitoring tools
 
### Volume and filesystem features
- NTFS features
  - built-in support for file and folder permission, compression, Encrypting File System (EFS) encryption, user quotas, data deduplication, journaling, and self-healing capability
- ReFS v3 features
   - data deduplication, improved performance with storage spaces
- Storage Replicas have better performance
- Storage Mitigation Service simplifies the moving of data

### Performance and reliability features
- Privileged mode
- Protected processes
- multitasking
- multithreading
- processor scalability
- server clustering

### Admin tools manage the servers and services on the network
- Server Manager
  - monitors and manages server local configurations or network servers
- Windows PowerShell
  - Provides features for computers running Windows and Windows Server
- Windows Admin Center
 - web-based management tool new to Windows Server 2019

### Small footprint installation options
- install Server 2019 with a minimal set of services, features, and functionality
- produces a smaller attack surface
- more suitable for cloud environments
  - uses far less server storage, memory, and processor resources
  - can be installed within a VM or used as a container
- Windows Server 2019 offers 2 small footprint installation options
- server core and nano server

### Hybrid cloud features
- Hybrid cloud
  - integration between on-premises Windows Servers and Windows Servers and services running in the Azure Cloud
- Window server azure network adapter feature
- azure update management feature
- azure site recovery feature
- Kubernetes software coordinates conatiner execution

### Linux application support
- Web apps running in the cloud run within Linux containers
- Microsoft's Windows Subsystem for Linux (WSL)
- Makes it easier for Web app developers to create and test Linux apps on their Windows 10 PCs

---

# Windows Server 2019 edition

### Windows Storage Server 2019
- Cannot be purchased directly from Microsoft
- OEMs can offer Windowd Storage Server 2019 on the server based products they sell
- windows storage server 2019 turns a server into a central storage center for data in an organization
  - take advantage of the storage utilities offered in Windows Server 2019
 
### Microft Hyper-V Server 2019
- Hyper-V hypervisor
- Each Windows server VM running it requires a valid license
- note: linux VM do not require a license
- Installs a small footprint version of Windows server
   - contains a powershell interface for creating and managing VM

 ---

# Preparing for a Windows Server 2019 Installation

- Perform advanced planning
- Review and exceed minimum hardware requirements
- Consider capacity planning questions
- Consider processing speed, paying attention to the number of processors
- Ensure server has enough memory for the applications that it will host
- Consider the amount and type of storage
  - Redundant Array of Independent Disks (RAID) in the BIOS of the server
  - Additional hard disks, SSDs, virtual machine hard disk files

---

# Installing Windows Server 2019

### Installation broken into 3 separate tasks
- obtaining installation media
- starting the installation process
- completing the installation process

---

# Obtaining Installation Media

### Common method used to install windows server
- booting a computer or VM from installation media
  - bootable DVD or USB flash drive or ISO image file
- Used disk-burning software to download ISO image
- Download the correct Windows Server 2019 ISo image file

---

# Starting the Installation Process

### Ensure BIOS boot order if necessary

### Create a new virtual machine within a virtualization configuration program
- Attach an ISO image file to the virtual DVD drive within the virtual machine
- Configure the virtual machine BIOS boot order
  - Boot from a DVD before the virtual hard disk file
- Start virtual machine within the virtual machine software
  - Machine boots ISO image attached to the virtual DVD
- Installation process starts

---

# Completing the Installation Process

- First step: enter regional locale and keyboard format
- Second step: choose whether to start an installation or repair a system
- Third step: select desired Windows Server 2019 edition
  - Accept the Microsoft license terms for Windows Server 2019
- Fourth step: select installation type - custom or upgrade
  - Normally, select Custom installation for new installation
- Fifth step: select Windows Server operating system storage location
- Reboot and specify a password for the local Administrator user account

---

# Post-installation Configuration

### Key configuration tasks following any Windows Server 2019 installation
- Setting the correct time and time zone
- Configuring the Internet Protocol (IP) on the server's network interfaces
- Configuring the firewall
- Changing the default computer name and domain membership
- Installing a modern Web browser
- Activating the Windows Server operating system

---

# Setting the Correct Time and Time Zone

### Within Server Manager
- Navigate to Local Server
- Select the hyperlink to Time zone in the Properties window
### Within the Windows Server Configuration Wizard on Server Core
- Select option 9 

--- 

# Configuring the Network

### Requirements to connect computer to a network
- Network interface, protocol, packets, routers, and other devices on a network

### Three default Windows protocols
- TCP/IP, UDP/IP, ICMP

### TCP ensures retransmission of lost packets

### IP network participant requires a valid Internet Protocol (IP) address
- IP version 4 (IPv4)
- IP version 6 (IPv6)

### Understanding IPv4

### Participation on an IPv4 network
- Requires valid IP address and a subnet mask
- Optionally requires configuration of a default gateway
- Unicast communication: from one computer to another computer using IP
- Octets: most common format for IPv4 addresses
- IPv4 address's two parts: network ID and host ID
- IPv4 address must be configured with a subnet mask

### Understanding IPv6
- Accommodates far more IP addresses: uses 128 bits to identify computers
- IP addresses written using 8 colon-delimited 16-bit hexadecimal numbers
- IPv6 addresses can be expressed several ways
- Adopted by small Internet-connected devices
  - Collectively referred to as the Internet of Things (loT)
  - Uses Teredo protocol to work within IPv4-only networks
- Proxy servers and Network Address Translation (NAT) routers allow more IPv4
addresses

### Configuring IP on a network interface
- Automatic from Dynamic Host Configuration Protocol (DHCP) or Boot
Protocol (BOOTP) server

### Process varies on IPv4 or IPv6 networks

### Automatic address assignment features
- Automatic Private IP Addressing (AP|PA)
- Internet Control Message Protocol version 6 (ICMPv6)

### Can manually configure IP on a network interface within Server Manager

---

# Configuring the Firewall

### Perimeter network or demilitarized zone (DMZ)
- Contains servers surrounded by routers
- Routers implement advanced firewall capabilities for traffic passing into network

### Disable or modify DMZ servers' firewall configurations within Server Manager
- Navigate to Local Server
- Select hyperlink next to Windows Defender Firewall in the Properties window 

--- 

# Changing the Default Computer Name and Domain Membership

### Installation assigns randomly generated computer name for the server

### Change within Server Manager
- Navigate to Local Server
- Select hyperlink next to Computer name in the Properties window
- Click the Change button and supply a new computer name

### Change within Windows Server Configuration Wizard on Server Core
- Select option 2

### Finish by joining the server to a domain 

---

# Installing a Modern Web Browser

### Default Windows Server 2019 Web browser: Internet Explorer
- Provided for legacy application support only

### Internet Explorer Enhanced Security Configuration (IE ESC) blocks Web sites

### Disable IE ESC within Server Manager
- Navigate to Local Server
- Select hyperlink next to lE Enhanced Security Configuration in the Properties window
- Disable IE ESC for all users or system administrators

----

# Activating the Windows Server Operating System

### Automatic activation performed based on Generic Volume License Key (GVLK)
- Requires organization's Key Management Services (KMS) installed on a network server
- Requires Active Directory-based Activation role installed on a domain controller within the domain

### Organization can purchase a retail product key or Multiple Activation Key (MAK)

### Activation within Server Manager by navigating to Local Server
- Select hyperlink next to Product ID in the Properties window
- Enter license key and click Activate to complete the activation process

---

# Selecting a Windows Server 2019 Lab Environment

### Hands-On Projects within this book will require Hyper-V

### Can install Windows Server 2019 directly on a computer
- Not necessarily practical

### Can use Windows 10 Professional, Enterprise, and Education editions
- These releases provide support for Hyper-V and nested virtualization

---

### Working with Server Manager
- Purpose: Server Manager is used to monitor and manage multiple Windows Server systems.
- Dashboard Panes: The Server Manager Dashboard includes a top Dashboard section, a Welcome pane (often hidden), and a Roles and Server Groups pane.
- Dashboard Visuals: The Dashboard uses various colors and icons for visual representation.
- Additional Panes: Other available panes in Server Manager include Events, Services, Best Practices Analyzer, Performance, and Roles and Features.

### Server roles introduced in Windows Server 2012
- storage spaces -> can be configured on any server that's been added to the Server Manager console.
  - How? File and Storage Services -> Volumes Subsection
- Server roles might have their own MMC tool for configuration.
  - server group or role section -> right click a server -> choose appropriate tool.
  
---

### Adding Roles and Features using Server Manager
- 3 ways to add roles and features within Server Manager
  - Select Add roles and features from the Welcome to Server manager Pane
  - Selecting Add Roles and Features from the Manage menu
  - Selecting Add Roles and Features from the Tasks menu within the Roles and Features pane for a server or server role

- no matter which method, Add Roles and Feature Wizard will guide you through installation.

---

### Using the BPA to Verify Server Roles
- after installing new server role -> run BPA scan
  - BPA scan -> determines whether your role configuration meets minimum guidelines by Microsoft
  - when BPA finds problems, you'll see the level of severity also a category within the results

- 3 levels of severity:
  - Information: Role is in compliance, but a change is recommended.
  - Warning: Role complies under current conditions, but may change if condition changes
  - Error: Role doesn't meet best practices, problems will be expected

- Different categories you'll see
  - Configuration: Shows whether role settings are configures for best peformance and avoid conflict within a server
  - Predeployment: shows whether prerequisites for the roles are properly installed or configures
  - Postdeployment: Indicates whether services needed for the role are started and running
  - Performance: Indicates whether the role can perform the tasks for which it is intended on-time and adequately for the intended workload
  - BPA Prerequisites: Indicates whether the role is set up in such a way that BPA can analyze the role. Failure here simply means that a component or setting prevented the BPA from properly analyzing the role.
 
---

### Working with the Windows Admin Center
- Server Manager oftens need you to:
  - coonect to Windows Server system
  - install RSAT on a windows 10 pc
- Windows Admin Center
  - New tool
  - wide range of monitoring
  - management functionality
  - remotley manage Windows Server 2019
  - manage in cloud environments
  - host a large number of remote windows server systems
  
---

### Installing the Windows Admin Center
- Option to download latest version, or regular version
- Starting the installer and navigating through setup screens, accepting the license, and configuring update and host settings.
- Responding to prompts regarding function capabilities, trusted host settings, and encryption certificate generation.
- Obtaining the URL to access the Admin Center, which is displayed on the final installation screen.

---

### Using Windows Admin Center
- Initial Setup & Access: Requires a valid login and guides users through a quick tour upon first use.
- Core Functionality: Places users at the connections screen, enabling management of the hosting server and the addition/tagging of Windows Server 2012 and later systems.
- Interface & Tools: Shares similarities with Server Manager and offers various tools within the navigation pane, including configuration, remote access, and Azure cloud integration.

---

### Configuring Server Hardware Devices
- Hardware devices include the following
  - Storage devices such as hard disks, SSDs, and optical drives
  - Disk controllers
  - Network interface adapters
  - Input devices such as keyboards and mice
  - Specialized devices
- **Plug and Play (PnP)** -> Allows your OS to work with hardware devices to automatically detect and configure recently installed hardware to work with the OS
- simple process of installing a PnP Device
  - Attach device
  - Wait for Windows Server 2019 to detect it
  - Install appropriate device drivers

---

### Adding Hardware Using Control Panel
- WS 2019 doesn't detect newly installed hardware, or if the device you are installing is not PNP
- **Device and Printer Utility** used to manually launch PnP or manaully install it without PnP
  - Device and printer utility can be used to:
    - Force the operating system to detect and install new PnP hardware
    - Install non-PnP hardware
    - Troubleshoot problems you might be having with existing hardware
   
    - Start it in the Control Panel two categories
      - Category view with utilities grouped by general function
      - Classic view instead, with individual utilities listed as icons
- Sample Task
  - Add device
  - Display device
  - Troubleshoot the device

 ---

### Using Device Manager
- The devices manager shows all devices on the system
- Open Device Manager from control panel to update device driver
  - generic or unknown will need an update to show full functionality
  - PnP hardware resource must be considered to prevent conflict
    - Interrupt Request (IRQ) line, Input/Output (I/O) address, reserved memory range
- Can check for a resource conflict and examine other device properties
  - Device Properties box has four tabs to review

---

### Verify System Files
- Invalid Signature Files
  - Overwritten, corrupted, modified by malware
- Window Server 2019 offers **System File Checker**
  - Scan system for integrity
  - replace damaged overwritten files with proper versions
- Another tool: File Signature Verifaction tool (Sigverif)
  - only scans files , doesnt overwrite inappropriate files
  - afte scanning, complete files are written to a log file, called `sigverif.txt`

### Configuring Windows Settings
- Configurable elements of the operating system
  - Performance options
  - Environment variables
  - Startup and recovery options
  - Power options
 
---

### Configuring Performance Options
- **Processor Scheduling**: allows you to configure how processor resources are allocated to programs.
- **Data Execution Prevention (DEP):** Monitors how programs use memory to ensure they are not causing memory problems.
- In Control Panel, navigate to System and Security, and select System
  - Select Advanced system settings, click Settings in the Performance section
  - Highlight Advanced tab or Data Execution Prevention tab

- Configuring Virtual Memory
  - **Virtual Memory:** disk storage used to expand the capacity of the physical memory installed in the computer.
    - uses a technique called pages
    - moves phyicals memory into virtual memory on disk
- **Paging file:** area of disk that is allocated
  - The location of the paging file is important
  - Parameters used to tune paging file size: initial size and maximum size
  - Configure initial size by multiplying amount of installed RAM times 1.5

- Configuring file caching
- File caching turned on by default
  - Speeds up the time it takes to read from or write to a disk

- Flushing
  - Freeing memory used for cached data after data written to disk
- Can turn off caching and flushing to easily hot swap a drive
  - Server can seem slower to users
  - May lose data during hot swap while the server is in use

---

### Configuring Environment Variables
- **Environment Variables**
  - used to tell the OS where to find programs and program related info.
- System environment variable are defined by the OS
  - apply to any user logged into the computer
- User variable environment can be defined on a per user basis and may be used to provide a wide variety of different info

---

### Configuring Power Options
- Power options that can be set
  - Select a power plan
  - Choose what the power button does
  - Create a power plan
  - Choose when to turn off the display
- Three power plans
  - Balanced, Power saver, and High performance
 
---

### Windows Registry
- Hierarchical:
  - Key: A folder that appears in the left pane of the Registry Editor and can contain subkeys and entries
  - Subkey: A part of the Windows Registry that is below a key. A subkey can contain entries or other subkeys.
  - Entry: An item that appears in the details pane and is the lowest level in the Windows Registry. An entry consists of an entry name, its data type, and its value.

- Five root keys:
  - HKEY_LOCAL_MACHINE
  - HKEY_CURRENT_USER
  - HKEY_USERS
  - HKEY_CLASSES_ROOT
  - HKEY_CURRENT_CONFIG

---

### Working with Windows PowerShell
- Command Structure & Redirection: PowerShell uses cmdlets for most commands and supports MS-DOS shell output redirection (>>) and command chaining (;).

- Piping & Filtering: Piping (|) allows sending information between cmdlets to create complex commands or filter output for desired results.

- Cmdlet Options: Many cmdlets offer options like --whatif, -confirm, -verbose, -debug, and -erroraction for controlling execution and debugging.

- Efficiency & Usability: PowerShell includes special navigation keys and key combinations, and its overall features aim to provide additional functionality and increase efficiency.

- Customizing Sessions: This involves altering the appearance or execution of PowerShell sessions, providing specific command options, and creating .psc1 console files.

- Aliases and Functions: Aliases are command shortcuts to simplify navigation, while functions enable the execution of multiple cmdlets.

- PowerShell Profile Scripts: These scripts, containing aliases and functions, are automatically executed when PowerShell starts for a user. Script execution must be enabled before creating them, and they can be edited using notepad $profile within PowerShell.

- Modifying Command Output: PowerShell provides various methods for manipulating command output, including piping output, using the -recurse option, and utilizing cmdlets like Sort-Object, Group-Object, ConvertTo-HTML, and Export-CSV.

- PowerShell objects
  - Attributes: These are properties that describe the object.
  - Methods: These are actions or functions that the object can perform.
  - Control: PowerShell objects provide the ability to manage various aspects of Windows, including processes, files, and network sockets.

- PowerShell Provider Plugins: These plugins offer functionality within Windows PowerShell and enable interaction with various system components.

- Filesystem Provider: This is identified as the default provider in PowerShell.

- Diverse Providers: In addition to the filesystem provider, numerous other providers exist, including those for variables, environment, aliases, functions, certificates, and the registry.

- Cmdlet Support: PowerShell supports a wide array of cmdlets, which are specialized commands used in the PowerShell environment.

---

### System Administration Commands
- Managing Windows roles, features, services, and processes.
- Configuring network settings and firewalls.
- Performing remote administration and executing scripts on multiple computers within a domain.
- Utilizing cmdlets to specify target computers for specific tasks.

---

### Using WMI within Windows Powershell
- WMI Consumers and Infrastructure: WMI consumers are programs that query WMI, while the WMI infrastructure comprises operating system components (namespaces, providers, classes) that respond to these queries.

- CIMv2 Namespace: This specific namespace (Common Information Model version 2) is used to query hardware and software components on systems and can also modify software components.

- Power of WMI: Administrators leverage WMI classes to query and manipulate system components, demonstrating the core utility of WMI.

---

### Creating PowerShell Scripts
-  PowerShell Scripts
  - It is a text file with a .ps1 extension executed within Windows PowerShell.
  - Commands within the script execute sequentially from top to bottom.
  - Its contents can include Windows commands, PowerShell cmdlets, and complex control structures.
  - PowerShell scripts enable code reusability in various situations.

- Enabling Script Support: Ensure script execution is enabled and verify the execution policy in Windows PowerShell.

- Executing within PowerShell: Scripts can be run using their full path (e.g., C:\scripts\myscript.ps1) or a relative path (e.g., .\myscript.ps1) when within the script's directory.

- Executing outside PowerShell: Scripts can be run by supplying the script path as an argument to a PowerShell command in the Windows Run dialog box or Command Prompt.

- Accessing and Creating Scripts: Windows PowerShell ISE can be found in the Start menu of Windows Server 2019. New scripts are created by clicking the Script icon and are initially named Untitled.ps1.

- Script Development: Users can modify, test, and save these scripts with descriptive names.

- Remote Scripting: PowerShell scripts can be created and tested on remote computers.

- Prerequisite for Remote Operations: To enable remote script execution, WinRM must be started within Windows PowerShell ISE.

- Variables and Constants: Both store values in memory for later use.

- Variables: Their values can be changed after being set, and in PowerShell, they start with a "$" and are not case-sensitive. Special characters and reserved words should be avoided in variable names.

- Constants: Their values cannot be changed once set.

- PowerShell Cmdlets: The Set-Variable cmdlet is used to manage variables, and adding -option constant to it creates a constant variable. Type casting can be used to modify text string behavior.

- Protecting Metacharacters: Special characters in PowerShell (like double-quotes, single-quotes, and back-quotes) need protection to be interpreted literally.

- Output Formatting: Coloring and using separator characters for variables improves the readability of PowerShell output.

- Decision Constructs: if and switch constructs are used to control the flow of a PowerShell script based on conditions that evaluate to true or false.

- Loop Constructs: Lists various loop types (foreach, for, while, do...while, do...until) used for repetitive task execution.

- Creating PowerShell Scripts: Emphasizes starting small, using comments, and ensuring scripts are adaptable to different objects.

- Finding PowerShell Scripts: Suggests utilizing websites with organized, reusable scripts and employing search engines like Google for broader searches.
