# Chapter 1

---


### Possession, Ownership, and Control
- Personal laptop = We possess it, we own it
- Company laptop = we possess it, we don't own it, our control depends on the organization
- Cell phone = we possess it, we own it, we don't control it since carriers, vendors, and app developers conrtol it

--- 

### Example of Control
- Phones can be vulnerable
- Vendors like Google and Apple try to block malware
  - Some malware creeps in anyway
 
- Free apps sell user data to 3rd parties or show ads

- track your location, recieve personal data
- apple blocks MAC address access by apps

---

### Making security decisions
- Car door = usually locked
- Room door = sometimes locked
- house door = Always locked

- Rule-based decision - following a standard
- Relativistic decision - copy others behavior
- Risk assessment - weighing the risk vs benefits

---

### Decision-making strategies
- Relativistic = my friend or someone I trust does it, I have to do it
- Risk Assessment = outweighing the benefits vs. risk

---

### Decision making in a life cycle

- Security Decisions
  - are there any weaknesses?
  - what security measures might work?
  - what are the downsides of this?
- Measure success
  - check for attacks or failures
  - recover from problems

  ---

### Risk Management Framework
- Prepare:
  - Define scope, context, priorities, resources
  - managing risk
 
- Categorize the information system:
  - Identifying goals, security risks, and requirements
 
- Select Security Controls:
  - identify existing controls, and additional ones are required

- implement security controls:
  - Construct the system containing the controls
 
- Assess security controls:
  - Verify the control works
 
- Authorize the information system:
  - approve the system for operation and use it
 
- monitor security controls:
  - watch and address security incidents
  - Review the environment for chages that affect security
 
---

### RMF Risk Assessment
- Rule Based -> US Federal standards and guidelines
- Identify RMF Categories -> sees the impact of cybersecurity failures
- Impact in terms of **CIA Properties**: Confidentiality, Intergrity, Availability
- Assess each in terms of impact
  - Low = some impact
  - High = Major damage
 
---

### Example of RMF Categorizations
- First Website shows public information: Selling widgets
  - Confidentiality: public information, so it's not applicable
  - Integrity: Low, since a site outage will not prevent customer sales
  - Availability: also low, site outage doesnt prevent customer sales
 
- Second Website shows public information: Selling widgets
  - Confidentiality: Moderate, since the website handles some electronic payment information from customers.
  - Integrity: Moderate, since the website handles some electronic payment information from customers, it specifies product prices, and it directs product shipments.
  - Availability: Moderate, since an interruption would visibly affect sales, but would not cause long-term damage to the company.
 
  ---

  ### RMF Uses Rules to Assign Controls
- Published rules recommend controls
  - NIST Special Publication 800-53
  - Add controls as impact increases

- Big vs small environments
  - Big business would absorb noticeable events
  - One event could destroy a small company

- RMF rules aren't geared for smaller buisnesses

---

### Do All Enterprises Do All RMF Steps?
- Prepare – NO, too often this is all ad hoc
- Categorize – NO, smaller ones do it differently
- Identify risks, threats, and requirements
- Select controls – YES, but a small enterprise
  - Combines with the Implement step
- Implement controls – YES
- Assess controls – YES
  - Determine if the controls really work
- Authorize system – NO, not in small enterprises
- Monitor controls – NO, not small enterprises

--- 

### Proprietor’s RMF

- Establish system and security goals = identify system's goals, secuitry risk, and requirements;
  - We perform risk assessment and make a list of security requirements
 
- Select security controls = identify existing controls and additional ones required and make the system containing the controls
  -  Use the security requirements to know the controls we need

- Validate the Information Sytem = check the control work as required, approce the system for operation, and use it
  - we test system control against the security requirments to ensure that we address out risk

- Monitor Security controls = look out for security incidents and address them, also check the environment for changes that affect security.
  - The system must have security controls that keep record of ssecurity-relevantoperations and incidents

---

### PRMF Risk Assessment

- Less elaborate process than RMF
  - inscribes the special cases of small businesses and nongovernment organizations
- PRMF Step A performs the assessment

- 3 major parts
  1. identify risk: assets, threat agents, attacks
  2. Prioritize risk: Estimate relative impacts
  3. Establish requirements: identify security goals to address the highest-priority risks

- Identifying risks
  - Step 1: Identify assets
  - Step 2: Identify threat actors and attacks
- Prioritizing risks
  - Step 3: Estimate the likelihood of attacks
  - Step 4: Estimate the impact of attacks
  - Step 5: Calculate their relative significance
- Establish requirements
  - Step 6: Write requirements to address the highest-priority risks

---

### Terminology
- Assets are protected by a boundary
- Openings in the boundary are vulnerabilities
- Attack surface represents the total of assets and the function
- A threat actor or attacker tries to attack assets
- Attack vector represents a method that a threat actor will use to attack anasset
- A defense, safeguard, or countermeasure protects the assets
- An attacked system that is unsafe to use is a compromised system
- Compromised systems on a network (or on many networks), all controlled by a single attacker, is a Botnet

---

### What are we protecting?
- for a small business
- How do we assess a boundary?
1. Can a threat actor breach a wall?
2. How do we control doorways?
3. How can a threat agent pass through a doorway?
4. How much do we trust those inside the boundary (the insider threat)?

--- 

### Least Privilege: A Basic Principle
- Restrict what people may do to an asset
- Provide the minimum privileges required
- Example: key opens my store but not yours

---

### Defense in Depth: Another Principle
- Improve security by making layers of defense
  - attackers must attack a lot of defenses to reach our valuable asset
 
- example:
- Layer 1: A robber might enter through the outer door
  - The door is locked when the store is closed
 
- Layer 2: Robber must enter the office area
  - only the manager can unlock the office

---

### Threat Actors
- Thinks about the people who perform attacks
- we can use published info to produce written profiles of specific groups that represent threat agents

---

### Examples of Specific Threat Actors
- Cyber-criminals: Kevin Mitnick, Jerry Schneider
- Criminal organizations
  - Forums used in cyber crime activities
  - Groups operating identified botnets
  - Vendors of software used in cyber crime
- Independent cybercriminal groups
  - Anonymous, Clop, Lazarus Group, LulzSec
- National actors

---

### National Actors
- Government Intelligence agencies = NCA, GCHQ

---

### Profiling a Threat Actor
- What are their goal?
- Their mode of operation (MO)
- Their motivations
- capabilities and logistical constraints

---

### Threat actor goals
- clout
- money
- overthrow a government?
- ideological victory?

--- 

### Typical MO 
- How targets are selected
- how operations are organized
- either broadly targeted attacks or a specific target
- individual or multiple coordianted attacks
- remote, onsite, insider, social engineering attacks

---

### Level of Motivation
- Unmotivated
- Scant = exploiting minor vulnerabilities
- Stealth = appliest effort, but avoids social stigma
- Low = causes harm and limited damage to assets
- Moderate = cause significant damage to assets or some injury to persons, but not critical injurties
- High = will cause significant disruption and/or critical injuries to achieve their goals

---

### Capabilities and Logistical Constraints
- Size of team, financial resources
- Geographical limitations and extradition considerations
- Does their training or skills affect their target choices?
- Are their activities simple in structure or complicated?

---

### Attacks and Risk
- Vulnerabilities make an attack possible
- threat actors implement attacks
- During an attack, threat actors attack, causing damage to one of your assets
  - Exploiting vulnerabilities
- A risk is an attack that is a likely to occur against an asset of value, and should always be worth protecting against

---

### Types of Attacks
1. Physical attack - availability attack
2. Denial of Service - availability
3. Subversion - modifying a system to work for the threat actor\
4. Masquerade - the system works on behalf of the wrong user
5. Disclosure - an attack confidentiality
6. Forgery - bogus message given to computers

---

### Terminology: “CIA” Properties
- Confidentiality
  - Keeping information secret
  - Avoiding disclosure vulnerabilities
- Integrity
  - Protecting information from improper charges
  - Avoiding forgery, subversion, and masquerade attacks
- Availability
  - Keeping systems available and in operation
  - Avoiding Denial of Service (DOS) attacks

---

### Identifying and Prioritizng Risks
- identifying risks
  - Step 1: Identify assets
  - Step 2: Identify threat actors and attacks
- Prioritizing risks
  - Step 3: Estimate the likelihood of attacks
  - Step 4: Estimate the impact of attacks
  - Step 5: Calculate their relative significance

---

### Assets
- Computer hardware and software
- Software recovery disks
- Computer customization
- Spreadsheets
- Online business and credentials
- Social media accounts and credentials

### Step 2: Identify Threats and Attacks
- Identify threat actors
  - Use assets and known attacks to guide you
- Create an attack matrix (optional)
  - Uses generic attack types to help identify more specific attacks the actors might perform
- Create a risk matrix
  - Lists likely attacks against specific assets

---

### Ethical Issues in Security Analysis
- This poses two problems
  - Is the search potentially damaging or illegal?
  - If a vulnerability is found, how do we handle the information?
- Possible cases of finding vulnerabilities
  - A search authorized by the system’s owner
  - An unauthorized search
  - An unplanned – and unexpected – discovery

---

# Chapter 3

---


### The file system
- Directories give us a hierarchical method of organizing files
  - All modern OS use a Hierarchical file system to organize files to directories
- Each file has a path name
- Identifies the directory entries to follow to find the file
- The file name selects the right file in the final directory in the path
- Files are owned by a user, usually the creator
- Access rights are tied to user identities
- Example: Bob can read the file, but Alice can’t

---

### File access rights
- OS gives us 4 access rights, we could remember by using the acronym CRUD
  - **Create** a new resource instance (new file)
  - **Read** the contents of a particular resource
  - **Update** or "write" or "modify" a particular resource
  - **Delete** or destroy an existing resource
- Two mechanisms to apply initial access rights
  - Default right: the system applies a set of permissions to all files a user creates. Common in Unix systems
  - Inherited Rights: the system give permissions inherited from one or more enclosing directories

---

### Directory access rights
- Directories or folders put together files in different parts of the hard drive
- file exists because it has a directory entry, we must change that directory to delete it.
- We don't have full control of the file unless we change its directory entry

---

### Executable Files and Malware
- data file like a word processing file, images, spreadsheets, used by a program or the os
- **Executable files** contain application programs or other programs
  - contains instructions to be executed by the CPU
  - always begins with a "file header"
 
---

### Computer Viruses
- Virus: infects an application program; it adds its own machine instructions to the end of the program's life.
- When the program executes, the virus executes and spreads to other programs on the computer
- modern OS attackers use "wrappers"
  - wrappers contain software that was legitimate but contained malware that ran invisibly.

---

### Examples of Modern Malware
- Conficker or Downadup – spread through Internet via Windows vulnerabilities created a botnet used for spam and malware distribution
- ZeuS – creates a botnet focused on financial fraud
- Stuxnet – attacks control logic in industrial plants; probable target was Iranian nuclear sites

---

### Sharing and Protecting files
- files and folders provide safety like a cabinet, boxes, or a jar
- OS controls program execution, RAM access, and access to files on hard disk
- Objective:
  - provide computing for authorized users
  - Preserve the chain of control
  - permit or prevent general sharing of info among users
- Risks – a generic set
  1. Denial of service: deletes some of the files or damages software, making the computer unusable
  2. Extortion: attacker threatening to leak info, demanding ransom, usually called ransomware
  3. Subversion: program gets a virus or some other malware damage
  4. Masquerade: user logs in pretending to be another user
  5. Disclosure: personal data is disclosed to other parties or the public
  6. Forgery: modifying the file without our knowledge, presenting their statement as ours

---

### Security Policies
- **Global Policies:** applied to all users by default
  - Isolation Policy: keep users separate
  - File sharing policy: let users share their files

- **Tailored policies**
  - Modify rights for specific sets of files
  - Specific tailoring
    - Privacy – block some files from sharing
    - Shared reading – share some blocked files
    - Shared updating – full rights for some users

---

### Security Controls
- We can rely only on the OS system protection as long as 2 properties remain true:
  1. The OS protection is invoked when accessing our protected file
  2. No way to bypass the OS to access our protected files

- Deny by Default: Basic principle
  - always start by denying access
  - add access rights
  - This makes it easier to assign the right permissions and achieve Least Privilege

---

### Managing Access rights
- An Access Matrix
  - a Full matrix is too big to manage
  - we can organize access rights by clustering it in one dimension

- Cluster by column: associate access rights with users or processes
- Cluster by row: associates access rights with resources like files

---

### Capabilities
- cluster the rights by column; we user capability based security.

---

### File Permission Flags
- Permission flags: Identify rights for a specific set of users
  - EX: Read, write, and execute access rights
- 3 specific classes of users
  - Owner Rights: user who **owns** the file
  - System Rights: privileged processes run by the **system**
  - World Rights: **all users** other than the owner and the system
- Carries great deal of redundancy: owner and system has full access to the file anways.
- Compact access rules specify world rights only
  - A simple way to list file security controls to enforce basic or global security policies
  - Specify the files, their owners, and the access rights for the other users on the system
  - These are “Logical” controls

---

### States and State diagram
- A technique to illustrate a system’s behavior
  - Each state is a separate situation
  - Arrows between states show transitions
    - A transition indicates both cause and effect
    - An event causes the transition
    - An action may take place at the transition
- A door may only be Open or Closed – two states
- The events Opening or Closing cause the transition between the states

---

### Information states
- Information States fundamentals
  - Storage state: infor is stored and is not currently processed. also called data at rest
  - Processing state: process uses the info to make decisions or change the info to another form. also called data in use
  - Transmission state: the info is moved from one system to another, usually over a network. this is data in motion
  - Transit state: Storage media containing info is transported form one lcoation to another. this is data in transit.

---

### The Security Patch Race
- A race begins when a security problem arises
  - The software developer races to develop a fix to eliminate the problem
  - Attackers race to write software that exploits the problem and lets them attack computers
  - Attack software is called an exploit
- Any computer that doesn’t patch the problem may be vulnerable to the exploit
- Window of vulnerability = time during which an exploit exists but Computers aren’t patched

---

### The Systems Patching Process
1. Receive vulnerability advisories
2. Analyze advisory recommendations
3. Test security patches
4. Apply security patches
5. Confirm patching
- This applies to all flaws, including security flaws
  - Security fixes may have higher priority

---

### System Hardening
- Hardening – modifying system configuration to make them more resistant to attack
- Sources of hardening standards
  - Center for Internet Security
  - DISA STIGs
  - Software manufacturers

---

### Technical Debt
- Technical debt – the presence of outdated / unsupported hardware, OS,and applications
- Two forms:
  - Current OS does not run on existing hardware
  - Application software does not run on current OS
- Causes:
  - Application software company out of business
  - Hardware company out of business
  - Upgrade cost not financially feasible
